  <%= render 'search' %>
</div>


<strong class="mouse-cords"></strong>

<div class = "back-to-index" >
  <%= link_to '< Go back to home', root_path, :class => "back-button" %>
</div>

<div class = 'todo-detailed' >
  <div class = "todo-full" >
    <div class = "row">
      <div class = "todo-body col-11" >
        <%= @todo.body %>
      </div>
      <div class = "close-button col-1" >
        <%= link_to '<i class="icons material-icons">close</i>'.html_safe, @todo, method: :delete, data:{confirm: "Are you sure ?"}, class: "delete-todo",
            :remote=> true %>
      </div>
    </div>
    <div class = "todo-det-time" >
      <%= @todo.created_at.strftime("%l.%M %P, %e %B %Y") %>
    </div>
    <div class = "row">
      <div class = "task-bar col-11">
        <p>Task completion</p>
        <div class="progress">
          <div class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
            <span class="progress-percent">0%</span>
          </div>
        </div>
      </div>
      <div class = "col-1 round active-button">
      <%= check_box_tag @todo.id, @todo.id, @todo.active,
          data: {url: url_for(action: :update, active:@todo.active, id:@todo.id), :remote => true, method: :patch }%>
          <label for="<%=@todo.id%>"></label>
      </div>
    </div>
    <div class = "share-section">
      <p class= "shared-with">Shared with : &nbsp</p>
      <p class = "shared-users">a</p><br>
      <button type="button" name="button">Share this </button>
    </div>
  </div>
  <div class = "comments">
    <%= render 'comments/comments' %>
  </div>
</div>
<div class = "new-comment">
  <%= render 'comments/form' %>
</div>
<script>
  $('.progress').click(function(event){

    var currentProgress = $('.progress-bar').attr('aria-valuenow');
    var xPosition = event.pageX - $(this).offset().left;

    newProgress = Math.round((xPosition/587)*100);

    $('.progress-bar').css('width',xPosition);
    $('.progress-bar').css('aria-valuenow',xPosition);
    $('.progress-percent').text(newProgress+"%");

    if (newProgress == 100){
      $(".comment-entry").val('Status of the task changed to Done.');
    }
    else{
      $(".comment-entry").val('Task has been updated from ' + currentProgress + ' to ' + newProgress + '.');
    }
    $('.asd').submit();
  });
</script>
